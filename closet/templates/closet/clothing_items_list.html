{% extends 'layout.html' %}

{% block title %}
    Wardrobe Wizard | Closet
{% endblock %}

{% block content %}
    <div class="container-md">
        <h2 class="mt-5 mb-3">Closet</h2>
        <div class="mb-3">
            <a href="{% url 'closet:new_item' %}" class="btn addbtn">Add New Clothing Item</a>
        </div>
        
        
        <!--Filter Feature-->
        <form method="get" action="">
            <label for="tag">Filter by Tag:</label>
            <select name="tag" id="tag" onchange="this.form.submit()">
                <option value="">-- All Tags --</option>
                {% for tag_option in tags %}
                    <option value="{{ tag_option.name }}" {% if tag_option.name == selected_tag %}selected{% endif %}>
                        {{ tag_option.name }}
                    </option>
                {% endfor %}
            </select>

            {% if selected_tag %}
                <a href="{% url 'closet:list' %}" style="
                    display: inline-block;
                    padding: 6px 12px;
                    margin-left: 10px;
                    background-color: #f44336;
                    color: white;
                    text-decoration: none;
                    border-radius: 4px;
                    font-size: 14px;
                ">Clear filter</a>
            {% endif %}
        </form>

        <!--Populating items by tags, each card is responsive to page size and will auto indent-->
        <div class="row">
            {% for item in items %}
            <div class="col">
                <div class="card text-center mb-3 testcard" style="width: 15rem;">
                    <article class="mt-3 mb-3">
                        <img 
                            class="image"
                            src="{{ item.image.url }}"
                            height = 150
                            width = 150
                            alt="{{ item.title }}"
                        />
                        <h4>
                            <div class="position-relative">
                                <a href="{% url 'closet:page' item.pk %}">
                                    {{ item.title }}
                                </a>
                            </div>
                        </h4>
                        
                        <p>Tags:
                            {% for tag in item.tags.all %}
                                <span>{{ tag }}</span>{% if not forloop.last %}, {% endif %} 
                                <!--adds commas to after tag except for last-->
                            {% endfor %}
                        </p>
                        <a href="{% url 'closet:delete-item' item.pk %}"
                        class="btn btn-danger"
                        onclick="return confirm('Are you sure you want to delete this item?');">
                            Delete
                        </a>
                    </article>
                </div>
            </div>
            {% empty %}
                <p>No items found for this tag.</p>
            {% endfor %}
        </div>


    </div>
{% endblock %}